# 阶段四：社交功能开发规划

## 📋 目标

实现评论、点赞、关注三大核心社交功能，让平台具备完整的社交互动能力。

---

## 🎯 功能模块

### 1. 评论功能

#### 1.1 一级评论
- 发布评论（帖子下方）
- 评论列表展示
- 评论删除（自己的评论）
- 评论点赞数显示

#### 1.2 二级评论（回复）
- 回复评论
- 显示回复对象
- 回复列表展示
- 回复删除

#### 1.3 评论展示
- 按时间倒序排列
- 分页加载
- 显示评论者信息（头像、昵称）
- 点击评论者跳转到主页

### 2. 点赞功能

#### 2.1 帖子点赞
- 点赞/取消点赞
- 点赞状态显示（已点赞/未点赞）
- 点赞数实时更新
- 防重复点赞

#### 2.2 评论点赞
- 点赞/取消点赞
- 点赞状态显示
- 点赞数实时更新

### 3. 关注功能

#### 3.1 关注操作
- 关注用户
- 取消关注
- 关注状态显示
- 防止关注自己

#### 3.2 关注列表
- 我的关注列表（分页）
- 粉丝列表（分页）
- 显示用户信息
- 点击跳转到用户主页

---

## 🔧 技术实现

### 后端API设计

#### 评论相关接口
```
POST   /api/post/{postId}/comment      # 发布评论
GET    /api/post/{postId}/comments     # 获取评论列表（分页）
DELETE /api/comment/{commentId}        # 删除评论
POST   /api/comment/{commentId}/like   # 点赞/取消点赞评论
```

#### 点赞相关接口
```
POST   /api/post/{postId}/like         # 点赞/取消点赞帖子
```

#### 关注相关接口
```
POST   /api/user/{userId}/follow       # 关注用户
DELETE /api/user/{userId}/follow       # 取消关注
GET    /api/user/{userId}/followers    # 获取粉丝列表（分页）
GET    /api/user/{userId}/following    # 获取关注列表（分页）
```

### 数据库表

已有表结构（无需修改）：
- `comment` - 评论表
- `post_like` - 帖子点赞表
- `comment_like` - 评论点赞表
- `follow_relation` - 关注关系表

---

## 📝 开发任务清单

### 任务1: 评论功能

#### 后端
- [ ] 创建CommentMapper接口
- [ ] 创建CommentMapper.xml
- [ ] 创建CommentService
- [ ] 创建CommentController
- [ ] 实现发布评论
- [ ] 实现评论列表查询
- [ ] 实现评论删除
- [ ] 实现二级评论

#### 前端
- [ ] 创建comment.js (API)
- [ ] 在PostDetail.vue中添加评论组件
- [ ] 评论输入框
- [ ] 评论列表展示
- [ ] 回复功能
- [ ] 评论删除

### 任务2: 点赞功能

#### 后端
- [ ] 创建LikeMapper接口
- [ ] 创建LikeMapper.xml
- [ ] 创建LikeService
- [ ] 在PostController中添加点赞接口
- [ ] 在CommentController中添加点赞接口

#### 前端
- [ ] 在Home.vue中添加点赞按钮
- [ ] 在PostDetail.vue中添加点赞按钮
- [ ] 点赞状态切换
- [ ] 点赞数实时更新

### 任务3: 关注功能

#### 后端
- [ ] 创建FollowMapper接口
- [ ] 创建FollowMapper.xml
- [ ] 创建FollowService
- [ ] 创建FollowController
- [ ] 实现关注/取消关注
- [ ] 实现关注列表查询
- [ ] 实现粉丝列表查询

#### 前端
- [ ] 创建follow.js (API)
- [ ] 在Profile.vue中实现关注按钮
- [ ] 关注/粉丝列表页面
- [ ] 关注状态切换

---

## 🎨 UI设计

### 评论区域设计
```
┌─────────────────────────────────────┐
│ 评论 (10)                            │
├─────────────────────────────────────┤
│ [输入框] 发表评论...        [发布]   │
├─────────────────────────────────────┤
│ 👤 用户A                             │
│    这是一条评论内容                   │
│    [回复] [点赞 5] [删除]  1小时前    │
│    └─ 👤 用户B 回复 用户A             │
│       这是一条回复                    │
│       [点赞 2]  30分钟前              │
├─────────────────────────────────────┤
│ 👤 用户C                             │
│    另一条评论...                      │
└─────────────────────────────────────┘
```

### 点赞按钮设计
```
未点赞：⭐ 10
已点赞：⭐ 10 (高亮显示)
```

### 关注按钮设计
```
未关注：[+ 关注]
已关注：[✓ 已关注]
```

---

## 🔄 开发顺序

### 第一步：评论功能（2-3天）
1. 后端API开发
2. 前端评论组件开发
3. 测试

### 第二步：点赞功能（1-2天）
1. 后端API开发
2. 前端点赞按钮集成
3. 测试

### 第三步：关注功能（1-2天）
1. 后端API开发
2. 前端关注功能集成
3. 关注/粉丝列表页面
4. 测试

**预计总时间：4-7天**

---

## 📊 预期成果

### 完成后的功能
- ✅ 用户可以评论帖子
- ✅ 用户可以回复评论
- ✅ 用户可以点赞帖子和评论
- ✅ 用户可以关注其他用户
- ✅ 用户可以查看关注列表和粉丝列表

### 完成度提升
- 当前：55%
- 预期：70%
- 提升：+15%

---

## 🧪 测试要点

### 评论功能测试
1. 发布评论
2. 查看评论列表
3. 回复评论
4. 删除自己的评论
5. 点赞评论

### 点赞功能测试
1. 点赞帖子
2. 取消点赞
3. 点赞数正确更新
4. 点赞状态正确显示
5. 防重复点赞

### 关注功能测试
1. 关注用户
2. 取消关注
3. 查看关注列表
4. 查看粉丝列表
5. 关注数正确更新

---

**开始阶段四开发！🚀**

**文档创建日期**: 2026-01-17
